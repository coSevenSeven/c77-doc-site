"use strict";(self.webpackChunkc_77_doc_site=self.webpackChunkc_77_doc_site||[]).push([[4098],{9005:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>u,frontMatter:()=>s,metadata:()=>o,toc:()=>p});var r=t(5893),i=t(1151);const s={title:"\u5176\u4ed6\u88dc\u5145",sidebar_label:"\u5176\u4ed6\u88dc\u5145",sidebar_position:3},a=void 0,o={id:"Swagger Typescript Api/extra",title:"\u5176\u4ed6\u88dc\u5145",description:"\u5ba2\u88fd typescript \u5167\u5bb9",source:"@site/docs/Swagger Typescript Api/extra.md",sourceDirName:"Swagger Typescript Api",slug:"/Swagger Typescript Api/extra",permalink:"/c77-doc-site/docs/Swagger Typescript Api/extra",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/Swagger Typescript Api/extra.md",tags:[],version:"current",sidebarPosition:3,frontMatter:{title:"\u5176\u4ed6\u88dc\u5145",sidebar_label:"\u5176\u4ed6\u88dc\u5145",sidebar_position:3},sidebar:"tutorialSidebar",previous:{title:"\u9032\u968e\u7528\u6cd5",permalink:"/c77-doc-site/docs/Swagger Typescript Api/advance"}},c={},p=[{value:"\u5ba2\u88fd typescript \u5167\u5bb9",id:"\u5ba2\u88fd-typescript-\u5167\u5bb9",level:2},{value:"\u6821\u6b63\u5f8c\u7aef\u578b\u5225",id:"\u6821\u6b63\u5f8c\u7aef\u578b\u5225",level:2},{value:"\u6821\u6b63 typescript \u578b\u5225",id:"\u6821\u6b63-typescript-\u578b\u5225",level:2},{value:"\u79fb\u9664\u4e0d\u9700\u8981\u7684 route",id:"\u79fb\u9664\u4e0d\u9700\u8981\u7684-route",level:2},{value:"\u5176\u4ed6",id:"\u5176\u4ed6",level:2},{value:"\u53c3\u8003",id:"\u53c3\u8003",level:2}];function l(e){const n={a:"a",code:"code",h2:"h2",li:"li",p:"p",pre:"pre",ul:"ul",...(0,i.a)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h2,{id:"\u5ba2\u88fd-typescript-\u5167\u5bb9",children:"\u5ba2\u88fd typescript \u5167\u5bb9"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:'import { generateApi } from "swagger-typescript-api";\n\nawait generateApi({\n  template: "path_to_template_dir",\n});\n'})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\u4f7f\u7528 generateApi \u7684 ",(0,r.jsx)(n.code,{children:"template"})," \u9078\u9805"]}),"\n",(0,r.jsxs)(n.li,{children:["swagger-typescript-api \u4f7f\u7528 ",(0,r.jsx)(n.a,{href:"https://eta.js.org/",children:"Eta"})," \u6a23\u677f\u7522\u751f typescript \u6587\u4ef6\uff0c",(0,r.jsx)(n.a,{href:"https://github.com/acacode/swagger-typescript-api/tree/master/templates",children:"github \u4e0a\u6709\u63d0\u4f9b\u5404\u6a23\u7248"}),"\u505a\u5ba2\u88fd"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"\u4f8b\u5982 swagger-typescript-api \u7528\u4e0b\u5217\u6a23\u677f\u7522\u751f api class\uff0c\u5982\u679c\u6709\u5176\u4ed6\u9700\u8981\u53ef\u4ee5\u76f4\u63a5\u8abf\u6574\u8a72\u6a23\u677f"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ejs",metastring:'title="api.ejs"',children:'\x3c!-- \u8a08\u7b97\u8cc7\u6599 --\x3e\n<%\nconst { apiConfig, routes, utils, config } = it;\nconst { info, servers, externalDocs } = apiConfig;\nconst { _, require, formatDescription } = utils;\n\nconst server = (servers && servers[0]) || { url: "" };\n\nconst descriptionLines = _.compact([\n  `@title ${info.title || "No title"}`,\n  info.version && `@version ${info.version}`,\n  info.license && `@license ${_.compact([\n    info.license.name,\n    info.license.url && `(${info.license.url})`,\n  ]).join(" ")}`,\n  info.termsOfService && `@termsOfService ${info.termsOfService}`,\n  server.url && `@baseUrl ${server.url}`,\n  externalDocs.url && `@externalDocs ${externalDocs.url}`,\n  info.contact && `@contact ${_.compact([\n    info.contact.name,\n    info.contact.email && `<${info.contact.email}>`,\n    info.contact.url && `(${info.contact.url})`,\n  ]).join(" ")}`,\n  info.description && " ",\n  info.description && _.replace(formatDescription(info.description), /\\n/g, "\\n * "),\n]);\n\n%>\n\n\x3c!-- \u662f\u5426\u7528 axios \u505a http client --\x3e\n<% if (config.httpClientType === config.constants.HTTP_CLIENT.AXIOS) { %> import type { AxiosRequestConfig, AxiosResponse } from "axios"; <% } %>\n\n\x3c!-- api \u63cf\u8ff0 --\x3e\n<% if (descriptionLines.length) { %>\n/**\n<% descriptionLines.forEach((descriptionLine) => { %>\n* <%~ descriptionLine %>\n\n<% }) %>\n*/\n<% } %>\n\n\x3c!-- api class \u662f\u5426\u4f7f\u7528 axios --\x3e\nexport class <%~ config.apiClassName %><SecurityDataType extends unknown><% if (!config.singleHttpClient) { %> extends HttpClient<SecurityDataType> <% } %> {\n\n\x3c!-- \u662f\u5426\u70ba\u55ae\u4e00 http client --\x3e\n<% if(config.singleHttpClient) { %>\n  http: HttpClient<SecurityDataType>;\n\n  constructor (http: HttpClient<SecurityDataType>) {\n    this.http = http;\n  }\n<% } %>\n\n\x3c!-- modular: true --\x3e\n<% if (routes.outOfModule) { %>\n  <% for (const route of routes.outOfModule) { %>\n\n  \x3c!-- \u8fed\u5e36\u5beb\u51fa\u6240\u6709 route \u65b9\u6cd5 --\x3e\n  <%~ includeFile(\'./procedure-call.ejs\', { ...it, route }) %>\n\n  <% } %>\n<% } %>\n\n\x3c!-- modular: false --\x3e\n<% if (routes.combined) { %>\n  <% for (const { routes: combinedRoutes = [], moduleName } of routes.combined) { %>\n  <%~ moduleName %> = {\n  <% for (const route of combinedRoutes) { %>\n\n  \x3c!-- \u8fed\u5e36\u5beb\u51fa\u6240\u6709 route \u65b9\u6cd5 --\x3e\n  <%~ includeFile(\'./procedure-call.ejs\', { ...it, route }) %>\n\n  <% } %>\n  }\n  <% } %>\n<% } %>\n}\n'})}),"\n",(0,r.jsx)(n.h2,{id:"\u6821\u6b63\u5f8c\u7aef\u578b\u5225",children:"\u6821\u6b63\u5f8c\u7aef\u578b\u5225"}),"\n",(0,r.jsxs)(n.p,{children:["\u4f7f\u7528 ",(0,r.jsx)(n.code,{children:"primitiveTypeConstructs"})," \u9078\u9805\uff0c\u6307\u5b9a\u5f8c\u7aef\u578b\u5225\u9810\u8a2d\u7684 typescript \u578b\u5225"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:'type PrimitiveTypeStructValue =\n  | string\n  | ((\n      schema: Record<string, any>,\n      parser: import("./src/schema-parser/schema-parser").SchemaParser\n    ) => string);\n\ntype PrimitiveTypeStruct = Record<\n  "integer" | "number" | "boolean" | "object" | "file" | "string" | "array",\n  | string\n  | ({ $default: PrimitiveTypeStructValue } & Record<\n      string,\n      PrimitiveTypeStructValue\n    >)\n>;\n\ndeclare const primitiveTypeConstructs: (\n  struct: PrimitiveTypeStruct\n) => Partial<PrimitiveTypeStruct>;\n\ngenerateApi({\n  // ...\n  primitiveTypeConstructs: (struct) => ({\n    integer: () => "number",\n    number: () => "number",\n    boolean: () => "boolean",\n    object: () => "object",\n    file: () => "File",\n    string: {\n      $default: () => "string",\n\n      /** formats */\n      binary: () => "File",\n      file: () => "File",\n      "date-time": () => "string",\n      time: () => "string",\n      date: () => "string",\n      duration: () => "string",\n      email: () => "string",\n      "idn-email": () => "string",\n      "idn-hostname": () => "string",\n      ipv4: () => "string",\n      ipv6: () => "string",\n      uuid: () => "string",\n      uri: () => "string",\n      "uri-reference": () => "string",\n      "uri-template": () => "string",\n      "json-pointer": () => "string",\n      "relative-json-pointer": () => "string",\n      regex: () => "string",\n    },\n    array: (schema, parser) => {\n      const content = parser.getInlineParseContent(schema.items);\n      return parser.safeAddNullToType(schema, `(${content})[]`);\n    },\n  }),\n});\n'})}),"\n",(0,r.jsx)(n.p,{children:"\u4f8b\u5b50\uff0cdate-time \u4e00\u5f8b\u6539\u70ba Date"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:'generateApi({\n  primitiveTypeConstructs: (struct) => ({\n    string: {\n      "date-time": "Date",\n    },\n  }),\n});\n'})}),"\n",(0,r.jsx)(n.h2,{id:"\u6821\u6b63-typescript-\u578b\u5225",children:"\u6821\u6b63 typescript \u578b\u5225"}),"\n",(0,r.jsxs)(n.p,{children:["\u4f7f\u7528 ",(0,r.jsx)(n.code,{children:"codeGenConstructs"})," \u9078\u9805\uff0c\u65b9\u6cd5\u985e\u4f3c ",(0,r.jsx)(n.code,{children:"primitiveTypeConstructs"}),"\uff0c\u6703\u8986\u84cb\u6307\u5b9a\u7684\u985e\u578b"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:'generateApi({\n  // ...\n  codeGenConstructs: (struct) => ({\n    Keyword: {\n      Number: "number",\n      String: "string",\n      Boolean: "boolean",\n      Any: "any",\n      Void: "void",\n      Unknown: "unknown",\n      Null: "null",\n      Undefined: "undefined",\n      Object: "object",\n      File: "File",\n      Date: "Date",\n      Type: "type",\n      Enum: "enum",\n      Interface: "interface",\n      Array: "Array",\n      Record: "Record",\n      Intersection: "&",\n      Union: "|",\n    },\n    CodeGenKeyword: {\n      UtilRequiredKeys: "UtilRequiredKeys",\n    },\n    /**\n     * $A[] or Array<$A>\n     */\n    ArrayType: (content) => {\n      if (this.anotherArrayType) {\n        return `Array<${content}>`;\n      }\n\n      return `(${content})[]`;\n    },\n    /**\n     * "$A"\n     */\n    StringValue: (content) => `"${content}"`,\n    /**\n     * $A\n     */\n    BooleanValue: (content) => `${content}`,\n    /**\n     * $A\n     */\n    NumberValue: (content) => `${content}`,\n    /**\n     * $A\n     */\n    NullValue: (content) => content,\n    /**\n     * $A1 | $A2\n     */\n    UnionType: (contents) => _.join(_.uniq(contents), ` | `),\n    /**\n     * ($A1)\n     */\n    ExpressionGroup: (content) => (content ? `(${content})` : ""),\n    /**\n     * $A1 & $A2\n     */\n    IntersectionType: (contents) => _.join(_.uniq(contents), ` & `),\n    /**\n     * Record<$A1, $A2>\n     */\n    RecordType: (key, value) => `Record<${key}, ${value}>`,\n    /**\n     * readonly $key?:$value\n     */\n    TypeField: ({ readonly, key, optional, value }) =>\n      _.compact([\n        readonly && "readonly ",\n        key,\n        optional && "?",\n        ": ",\n        value,\n      ]).join(""),\n    /**\n     * [key: $A1]: $A2\n     */\n    InterfaceDynamicField: (key, value) => `[key: ${key}]: ${value}`,\n    /**\n     * $A1 = $A2\n     */\n    EnumField: (key, value) => `${key} = ${value}`,\n    /**\n     * $A0.key = $A0.value,\n     * $A1.key = $A1.value,\n     * $AN.key = $AN.value,\n     */\n    EnumFieldsWrapper: (contents) =>\n      _.map(contents, ({ key, value }) => `  ${key} = ${value}`).join(",\\n"),\n    /**\n     * {\\n $A \\n}\n     */\n    ObjectWrapper: (content) => `{\\n${content}\\n}`,\n    /**\n     * /** $A *\\/\n     */\n    MultilineComment: (contents, formatFn) =>\n      [\n        ...(contents.length === 1\n          ? [`/** ${contents[0]} */`]\n          : ["/**", ...contents.map((content) => ` * ${content}`), " */"]),\n      ].map((part) => `${formatFn ? formatFn(part) : part}\\n`),\n    /**\n     * $A1<...$A2.join(,)>\n     */\n    TypeWithGeneric: (typeName, genericArgs) => {\n      return `${typeName}${\n        genericArgs.length ? `<${genericArgs.join(",")}>` : ""\n      }`;\n    },\n  }),\n});\n'})}),"\n",(0,r.jsx)(n.p,{children:"\u4f8b\u5b50\uff0c\u7269\u4ef6\u985e\u578b\u7d71\u4e00\u70ba Record"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:'generateApi({\n  // ...\n  codeGenConstructs: (struct) => ({\n    Keyword: {\n      Object: "Record<string, any>",\n    },\n  }),\n});\n'})}),"\n",(0,r.jsx)(n.h2,{id:"\u79fb\u9664\u4e0d\u9700\u8981\u7684-route",children:"\u79fb\u9664\u4e0d\u9700\u8981\u7684 route"}),"\n",(0,r.jsxs)(n.p,{children:["\u898b ",(0,r.jsx)(n.a,{href:"https://github.com/acacode/swagger-typescript-api/issues/380#issuecomment-1310233036",children:"api calls names #380"})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:'import { generateApi } from "swagger-typescript-api";\n\nawait generateApi({\n  hooks: {\n    onPrepareConfig: (config) => {\n      if (!config.routes.combined) return;\n\n      config.routes.combined = config.routes.combined.filter(\n        (r) => r.moduleName !== "auth"\n      );\n    },\n  },\n});\n'})}),"\n",(0,r.jsx)(n.h2,{id:"\u5176\u4ed6",children:"\u5176\u4ed6"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:'import { generateApi } from "swagger-typescript-api";\n\nawait generateApi({\n  // \u8f38\u51fa\u6a94\u6848\u540d\u7a31\uff0c\u5982\u679c\u8f38\u51fa\u7d50\u679c\u662f\u591a\u500b\u6a94\u6848 ( \u4f8b\u5982\u555f\u7528 modular ) \u5c31\u4e0d\u6703\u7528\u5230\uff1b\u4e0d\u8a2d\u5b9a\u5c31\u6703\u8b8a\u6210 .ts\n  name: "MySuperbApi.ts",\n\n  // \u9810\u8a2d api \u56de\u50b3\u8cc7\u6599\u662f\u4e0d\u662f\u53ea\u6709\u6210\u529f\u6c92\u6709\u5931\u6557\uff0c\u6703\u5f71\u97ff\u8acb\u6c42\u5931\u6557 Error \u7684\u578b\u5225\n  defaultResponseAsSuccess: true,\n\n  // \u7522\u751f HttpClient\uff0c\u4e5f\u5c31\u662f\u547c\u53eb api \u65b9\u6cd5\u7684 class\uff0c\u8a2d\u5b9a false \u5c31\u53ea\u6703\u7522\u751f\u76f8\u95dc interface\n  generateClient: true,\n\n  // \u4e0d\u592a\u78ba\u5b9a\u5728\u505a\u4ec0\u9ebc\uff0c\u8a2d\u5b9a true \u6703\u6839\u64da\u6bcf\u500b route \u7522\u751f namespace\n  generateRouteTypes: false,\n\n  // \u7522\u751f js \u6a94\u6848\uff0c\u800c\u4e0d\u662f ts\uff0c\u4f46\u662f\u6703\u63d0\u4f9b .d.ts \u6a94\u6848\n  toJS: false,\n\n  /*\n  \u5404 route method \u8acb\u6c42\u53c3\u6578\u8f38\u51fa\u6210\u578b\u5225\uff0c\u4e0b\u9762\u662f\u5927\u6982\u7684\u793a\u610f\u5167\u5bb9\n\n  type RequestRecord = ({ Id: string }) => Promise<RecordSet>\n\n  \u8b8a\u6210\n\n  type RequestRecordParams = { Id: string }\n  type RequestRecord = (params: RequestRecordParams) => Promise<RecordSet>\n  */\n  extractRequestParams: false,\n\n  // \u540c\u4e0a\uff0c\u4f46\u5c0d\u8c61\u662f body\n  extractRequestBody: false,\n\n  // prettier \u8a2d\u5b9a\uff0c\u9810\u8a2d\u6703\u8b80\u53d6\u5c08\u6848\u7684 prettier \u8a2d\u5b9a\n  prettier: {\n    printWidth: 120,\n    tabWidth: 2,\n    trailingComma: "all",\n    parser: "typescript",\n  },\n\n  // \u5982\u679c\u6c92\u6709 response \uff0c\u8a72 response \u578b\u5225\u5b9a\u7fa9\uff0c\u9ed8\u8ba4\u4e3avoid\n  defaultResponseType: "void",\n\n  // \u898b https://juejin.cn/post/7205198600015003685#heading-18\n  enumNamesAsValues: false,\n\n  // \u898b https://juejin.cn/post/7205198600015003685#heading-6\n  generateUnionEnums: false,\n\n  // \u7522\u751f\u7684\u578b\u5225\u540d\u7a31\u9644\u52a0\u7684\u524d\u5f8c\u8f1f\n  typePrefix: \'\',\n  typeSuffix: \'\',\n\n  // \u7522\u751f\u7684 enum \u540d\u7a31\u9644\u52a0\u7684\u524d\u5f8c\u8f1f\n  enumKeyPrefix: \'\',\n  enumKeySuffix: \'\',\n\n  // generate readonly properties (default: false)\n  addReadonly: false,\n\n  /**\n   extraTemplates (NodeJS option)\n   @see https://github.com/acacode/swagger-typescript-api?tab=readme-ov-file#extratemplates-nodejs-option\n    type (Record<string, any> & { name: string, path: string })[]\n    This thing allow you to generate extra ts\\js files based on extra templates (one extra template for one ts\\js file)\n    [Example here]{@link https://github.com/acacode/swagger-typescript-api/tree/next/tests/spec/extra-templates}\n   */\n  extraTemplates: []\n\n  // \u662f\u5426\u555f\u7528 primitiveTypeConstructs \u7684 array \u529f\u80fd\n  anotherArrayType: false,\n\n  // prefix string value needed to fix invalid type names (default: \'Type\')\n  // \u4f7f\u7528\u524d\u8f1f\u4fee\u6b63 type \u7121\u6548\u7684\u540d\u7a31\n  fixInvalidTypeNamePrefix: "Type",\n\n  /*\n    prefix string value needed to fix invalid enum keys (default: \'Value\')\n    \u4f7f\u7528\u524d\u8f1f\u4fee\u6b63 enum \u7121\u6548\u7684 key \u540d\u7a31\n\n    export enum SystemReflectionTypeAttributes {\n      // \u4e0d\u7b26\u5408 ts \u898f\u5247\n      0 = 0\n      // \u52a0\u4e0a\u524d\u8f1f\u4fee\u6b63\n      Value0 = 0\n    }\n  */\n  fixInvalidEnumKeyPrefix: "Value"\n});\n'})}),"\n",(0,r.jsx)(n.h2,{id:"\u53c3\u8003",children:"\u53c3\u8003"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://juejin.cn/post/7239542388602912823",children:"\u524d\u7aef\u5de5\u7a0b\u5316\u4e4b\u2014\u2014\u81ea\u52a8\u751f\u6210\u57fa\u4e8e Typescript \u7684 API \u6a21\u5757\uff08\u6587\u672b\u6709 npm \u5305\u53ef\u7528\uff09"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://juejin.cn/post/7205198600015003685",children:"swagger-typescript-api \u4e2d\u6587\u8be6\u89e3"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://github.com/acacode/swagger-typescript-api",children:"swagger-typescript-api (Github)"})}),"\n"]})]})}function u(e={}){const{wrapper:n}={...(0,i.a)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(l,{...e})}):l(e)}},1151:(e,n,t)=>{t.d(n,{Z:()=>o,a:()=>a});var r=t(7294);const i={},s=r.createContext(i);function a(e){const n=r.useContext(s);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),r.createElement(s.Provider,{value:n},e.children)}}}]);